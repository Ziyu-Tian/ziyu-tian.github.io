
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Ziyu Tian's Website">
      
      
        <meta name="author" content="Ziyu Tian">
      
      
        <link rel="canonical" href="https://ziyu-tian.github.io/NOTES/Stage_3/DSP_Report/">
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>DSP Report - Nothing except Notes</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../mkdocs/css/no-footer.css">
    
      <link rel="stylesheet" href="../../../mkdocs/css/unordered-list-symbols.css">
    
      <link rel="stylesheet" href="../../../live2d-widget/waifu.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#i-introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Nothing except Notes" class="md-header__button md-logo" aria-label="Nothing except Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Nothing except Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              DSP Report
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="orange"  aria-label="切换至日间模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="切换至日间模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Ziyu-Tian/ziyu-tian.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    ziyu-tian.github.io
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../" class="md-tabs__link">
          
  
  
    
  
  Notes

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../DEV/" class="md-tabs__link">
          
  
  
    
  
  Dev

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../BLOGS/" class="md-tabs__link">
          
  
  
    
  
  Blog

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Nothing except Notes" class="md-nav__button md-logo" aria-label="Nothing except Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Nothing except Notes
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Ziyu-Tian/ziyu-tian.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    ziyu-tian.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Notes
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_2" >
        
          
          <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Stage1_Notes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            Stage1_Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Stage_1/1000/Job_Application/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Job Application
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Stage_1/1000/Placement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Placement Year
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Stage_1/1001/EngineeringMath/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Engineering Mathematics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Stage_1/Coding/C/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    C Programing Basic
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Stage_1/Coding/Matlab/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MATLAB Basic
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Stage_1/Coding/PythonDataAnalysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python Data Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_3" >
        
          
          <label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Electronics Notes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3">
            <span class="md-nav__icon md-icon"></span>
            Electronics Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Electronics/FundamentalElectricCircuits/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fundamentals of Electric Circuits
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_4" >
        
          
          <label class="md-nav__link" for="__nav_1_4" id="__nav_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Stage2_Notes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4">
            <span class="md-nav__icon md-icon"></span>
            Stage2_Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Stage_2/semiconductor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Semiconductors Devices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Stage_2/signalsAndCommunication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Signals and Communication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Stage_2/computerSystems/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Computer Systems and Microprocessors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Stage_2/analogElectronic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Analogue Electronics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Stage_2/microProcessors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Microprocessors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Stage_2/digitalElectronics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Digital Electronics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Stage_2/vhdl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VHDL Basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Stage_2/statisticalMethod/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Statistical Method
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Stage_2/acElectrical/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AC Electrical Power
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Stage_2/automaticControl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Automatic Control Systems
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_5" >
        
          
          <label class="md-nav__link" for="__nav_1_5" id="__nav_1_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Stage3_Notes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5">
            <span class="md-nav__icon md-icon"></span>
            Stage3_Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Industrial_Control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Industrial Control and PLC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Introduction_to_Law/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    introduction to Business Law
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Digital_Signal_Process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Digital Signal Processing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../DEV/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Dev
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Dev
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DEV/TimeComplexity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Time & Space Complexity
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DEV/StaticInC/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Static modifier in C
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DEV/ValueRefPass/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pass-by-Value & Pass-by-Reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DEV/BitOperation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bit Operation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../BLOGS/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BLOGS/BlogsZero/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blogs_Zero
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BLOGS/Thoughts_220822/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Thoughts 22/08/22
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BLOGS/Thoughts_240822/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Thoughts 24/08/22
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BLOGS/Literature_260822/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Poem Thoughts 26/08/22
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#i-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      I: Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ii-task-1-original-am-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      II: Task-1: Original AM Analysis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iii-task-2-band-passs-iir-design" class="md-nav__link">
    <span class="md-ellipsis">
      III: Task-2: Band-passs IIR Design
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iv-task-3-siginal-mixing" class="md-nav__link">
    <span class="md-ellipsis">
      IV: Task-3: Siginal Mixing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#v-task-4-low-pass-fir-design" class="md-nav__link">
    <span class="md-ellipsis">
      V: Task-4: Low-pass FIR Design
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vi-task-5-dc-removing" class="md-nav__link">
    <span class="md-ellipsis">
      VI: Task-5: DC Removing
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>DSP Report</h1>

<div align='center' ><font size ='6'>EEE3030 Digital Signal Processing Report </font> </div>

<div align='center' ><font size ='3'>Ziyu Tian</font> </div>

<h2 id="i-introduction"><font size=5 face=Times New Roman>I: Introduction</font><a class="headerlink" href="#i-introduction" title="Permanent link">&para;</a></h2>
<p><font size=3 face=Times New Roman></p>
<p>This assignment aims at building a AM demodulator system shown in Fig.1, which should be implemented based on appropriate digital filter codes in MATLAB. The designed AM demodulator would be implemented on the given .wav soundtrack to extract the contained message finally. In the following report, I would demonstrate the detailed solution for the five given tasks separately combined with necessary MATLAB codes.
</font></p>
<p><img alt="" src="../image/2023-12-09-14-16-23.png" />
<font size=2><center><em>Fig.1</em>. AM Demodulator System Block Diagram </center></font></p>
<h2 id="ii-task-1-original-am-analysis"><font size=5 face=Times New Roman>II: Task-1: Original AM Analysis</font><a class="headerlink" href="#ii-task-1-original-am-analysis" title="Permanent link">&para;</a></h2>
<p><font size=3 face=Times New Roman> 
Using the audioread() function in MATLAB, the .wav file could be read into the demodulation system with the sampling rate 'F_s' and amplitude array 'y'. Combined with the time-axis array and the length() function, the AM signal in time domain could be plotted in Fig.2 by following MATLAB codes:</p>
<div class="highlight"><pre><span></span><code><span class="c">% Read wav file</span>
<span class="n">filename</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;Ziyu Tian.wav&#39;</span><span class="p">;</span>
<span class="p">[</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">Fs</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">audioread</span><span class="p">(</span><span class="n">filename</span><span class="p">);</span>

<span class="c">% Calculate soundtrack duation time</span>
<span class="nb">duration</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">length</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Fs</span><span class="p">;</span>

<span class="c">% Time Domain</span>
<span class="nb">time</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">duration</span><span class="p">,</span><span class="w"> </span><span class="nb">length</span><span class="p">(</span><span class="n">y</span><span class="p">));</span>
<span class="nb">figure</span><span class="p">;</span>
<span class="nb">plot</span><span class="p">(</span><span class="nb">time</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">);</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Time Domain&#39;</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Time (s)&#39;</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Amplitude&#39;</span><span class="p">);</span>
</code></pre></div>
<p><img alt="" src="../image/2023-12-09-14-22-39.png" />
<font size=2><center><em>Fig.2</em>. AM signal in time domain </center></font></p>
<p>According to the soundtrack in Fig.2, the total length of the .wav file is 2.27 seconds with obvious noises . </p>
<p>To show the original AM signal in frequency domain, a Fast Fourier Transform operation is needed to complete the conversion. As the sampling frequency is 96 kHz and the sound length is 2.27 s, the total samples should be calculated as:</p>
<div class="arithmatex">\[
n = F_s . t = 2.27\times96000 = 217920
\]</div>
<p>The number 217900 is close to the result calculated by MATLAB length(), which is 217992. The sampling number n could be used as the Number of FFT directly, however, for the purpose of improving FFT efficiency, we normally choose the closet power of 2 to the total samples number. Applied with the nextpow2() function, the appropriate Number of FFT N could be found as 262144 by the codes below:</p>
<div class="highlight"><pre><span></span><code><span class="c">% Frequency Domain</span>
<span class="n">n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">length</span><span class="p">(</span><span class="n">y</span><span class="p">);</span><span class="w"> </span><span class="c">% Use length of sound as FFT points, which meet the requirement of frequency resolution</span>
<span class="n">N</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">pow2</span><span class="p">(</span><span class="nb">nextpow2</span><span class="p">(</span><span class="n">n</span><span class="p">));</span>
</code></pre></div>
<p>In this condition, the Frequency of Resolution could be calculated as:</p>
<div class="arithmatex">\[
FR = \displaystyle\frac{F_s}{N} = \displaystyle\frac{96000}{262144} = 0.367
\]</div>
<p>The size of window in this case would be calculated as 6.20 s, which would result in FFT spectral leakage. To reduce this problem, a Hamming Window is chosen to applied before the FFT operation. In addition, due to the extra sampling points in FFT compared to original AM signal, the zero-padding operation is necessary. The following codes shown the window-adding and FFT process:</p>
<div class="highlight"><pre><span></span><code><span class="n">frequencies</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Fs</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">);</span>
<span class="n">frequencies</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">frequencies</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="p">;</span><span class="w"> </span><span class="c">% Change unit to kHz</span>
<span class="n">y_padded</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="n">y</span><span class="p">;</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="n">N</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)];</span><span class="w">  </span><span class="c">% Zero-padding to match N</span>
<span class="n">Y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">fft</span><span class="p">(</span><span class="n">y_padded</span><span class="p">);</span><span class="w"> </span><span class="c">% FFT</span>
<span class="c">% Hamming Windows applied </span>
<span class="n">window</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">hamming</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
<span class="n">Y_windowed</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">fft</span><span class="p">(</span><span class="n">y_padded</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="n">window</span><span class="p">);</span>
</code></pre></div>
<p>For the purpose of normalization and scaling, I normalized the signal amplitude with the chosen Number of FFT and converted it into decibel expression before plotting:</p>
<div class="highlight"><pre><span></span><code><span class="c">% Amplitude Normalization </span>
<span class="n">amplitude</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="p">;</span><span class="w"> </span>

<span class="c">% Amplotude Scaling to dB</span>
<span class="n">amplitude_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">log10</span><span class="p">(</span><span class="n">amplitude</span><span class="p">);</span><span class="w"> </span>

<span class="c">% According to Nyquist Limit, a half frequencies are enough</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">frequencies</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">amplitude_dB</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="s">&#39;b&#39;</span><span class="p">);</span><span class="w"> </span>
<span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
<span class="n">amplitude_windowed</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">Y_windowed</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">N</span><span class="p">;</span>
<span class="n">amplitude_windowed_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">log10</span><span class="p">(</span><span class="n">amplitude_windowed</span><span class="p">);</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">frequencies</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">amplitude_windowed_dB</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="s">&#39;r&#39;</span><span class="p">);</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Frequency Domain&#39;</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Frequency(kHz)&#39;</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Amplitude (dB)&#39;</span><span class="p">);</span>
<span class="nb">legend</span><span class="p">(</span><span class="s">&#39;Original Signal&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Hamming Processed Signal&#39;</span><span class="p">);</span>
</code></pre></div>
<p>To compare the difference between original signal and Hamming Windowed signal, I plotted the both signal together as shown in Fig.3:</p>
<p><img alt="" src="../image/2023-12-09-15-30-15.png" />
<font size=2><center><em>Fig.3</em>. Comparison between Original Signal and Windowed Signal in frequency domain </center></font></p>
<p>From the spectrum shown in Fig.3, the Hamming Window reduced the spectral leakage effectively. From the windowed graph, it is also clear to find the Carrier Signal in the middle with the highest amplitude, which is 20 kHz. The upper and lower sideband could be found at both sides of the Carrier Signal, with the frequency of 20.42 kHz and 19.57 kHz respectively.</p>
<p></font></p>
<h2 id="iii-task-2-band-passs-iir-design"><font size=5 face=Times New Roman> III: Task-2: Band-passs IIR Design </font><a class="headerlink" href="#iii-task-2-band-passs-iir-design" title="Permanent link">&para;</a></h2>
<p><font size=3 face=Times New Roman> </p>
<p>In this task, a IIR band-pass would be designed to remove the noises out of <span class="arithmatex">\(f_c + B\)</span> to <span class="arithmatex">\(f_c -B\)</span>. In this case with <span class="arithmatex">\(fc = 20\)</span> kHz and <span class="arithmatex">\(B = 4\)</span> kHz, the range of the band-pass filter should be 16 kHz to 24 kHz. With the normalized cut-off frequencies, the coefficients of a Butterworth band-pass filter could be generated with the following instructions:</p>
<div class="highlight"><pre><span></span><code><span class="n">fs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">96000</span><span class="p">;</span><span class="w"> </span><span class="c">% sampling frequency </span>
<span class="n">fp1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">16000</span><span class="p">;</span><span class="w"> </span><span class="c">% lower cutting frequency </span>
<span class="n">fp2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">24000</span><span class="p">;</span><span class="w"> </span><span class="c">% upper cutting frequency </span>
<span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">butter</span><span class="p">(</span><span class="mi">2</span><span class="p">,[</span><span class="n">fp1</span><span class="p">,</span><span class="n">fp2</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">fs</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="s">&#39;bandpass&#39;</span><span class="p">);</span><span class="w">  </span><span class="c">% Butterworth IIR Bandpass </span>
</code></pre></div>
<p>According to the principle of IIR filter, a second order transfer function in z-domain could be expressed as:</p>
<div class="arithmatex">\[
H(z) = \displaystyle\frac{\Sigma^N_{k=0}b_k.z^{-k}}{1+\Sigma^M_{k=1}a_k.z^{-k}} = \frac{b_0 + b_1z^{-1} + b_2z^{-2} + b_3z^{-3} + b_4z^{-4}}{a_0+a_1z^{-1}+a_2z^{-2}+a_3z^{-3}+a_4z^{-4}}
\]</div>
<p>The MATLAB codes above could generate the coefficient <span class="arithmatex">\(b_0\)</span> to <span class="arithmatex">\(b_4\)</span> and <span class="arithmatex">\(a_0\)</span> to <span class="arithmatex">\(a_4\)</span>, which are stored in the array b and a.</p>
<p>To implement the filter in more generalized method, we should convert the z-domain expression of the Filter Transfer Function <span class="arithmatex">\(H(z)\)</span> into difference equation form with the same coefficients:</p>
<div class="arithmatex">\[
y[n] = \displaystyle\Sigma^N_{k=0}{b_k.x[n-k]}-\displaystyle\Sigma^M_{k=1}{a_k.y[n-k]}
\]</div>
<p>The low-level codes of the IIR design with difference equation could be expressed as below:</p>
<p><div class="highlight"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">262144</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">512</span><span class="p">);</span><span class="w"> </span><span class="c">% Generate a Random Noises with same sampling points of AM signal (N = 262144)</span>
<span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="n">window</span><span class="o">&#39;</span><span class="p">;</span>

<span class="n">Order</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="c">% The highest order of the z-domain Transfer Function</span>
<span class="n">delay_x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="n">Order</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="w">      </span><span class="c">% Create Delay Array for x and intialize with zeros (input)</span>
<span class="n">delay_y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="n">Order</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="w">        </span><span class="c">% Create Delay Array for x and intialize with zeros (output)</span>

<span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="p">=</span><span class="n">Order</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="w">          </span>
<span class="w">        </span><span class="n">delay_x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">delay_x</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span><span class="w">      </span><span class="c">% Right-shift the delay_x Array </span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">delay_x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="nb">i</span><span class="p">);</span><span class="w">              </span><span class="c">% Input each sample from signal x to the beginning of delay_x</span>

<span class="w">    </span><span class="n">Accumulator</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">                    </span><span class="c">% Clear the Accumulator until the end of x-signal</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="n">Order</span><span class="o">+</span><span class="mi">1</span><span class="w">                     </span><span class="c">% Calculate the result from input x                     </span>
<span class="w">        </span><span class="n">Accumulator</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Accumulator</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">delay_x</span><span class="p">(</span><span class="n">n</span><span class="p">);</span><span class="w">    </span><span class="c">% + b(n)*x(i-n)</span>
<span class="w">    </span><span class="k">end</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="p">=</span><span class="mi">2</span><span class="p">:</span><span class="n">Order</span><span class="o">+</span><span class="mi">1</span><span class="w">                       </span><span class="c">% Calculate the result from output y                    </span>
<span class="w">        </span><span class="n">Accumulator</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Accumulator</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">delay_y</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span><span class="w">    </span><span class="c">% -a(n)*y(i-n-1)</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">BP_IIR</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Accumulator</span><span class="p">;</span><span class="w">        </span><span class="c">% Store the output data of this sample x(i)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="p">=</span><span class="n">Order</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="w">          </span>
<span class="w">        </span><span class="n">delay_y</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">delay_y</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span><span class="w">      </span><span class="c">% Right-shift the delay_y Array </span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">delay_y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Accumulator</span><span class="p">;</span><span class="w">           </span><span class="c">% Input each sample from signal x to the begining of delay_x</span>
<span class="k">end</span>

<span class="nb">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">pspectrum</span><span class="p">(</span><span class="n">BP_IIR</span><span class="p">,</span><span class="n">fs</span><span class="p">)</span><span class="w"> </span><span class="c">% Plotting filtered signal</span>
<span class="nb">hold</span><span class="w"> </span><span class="n">on</span><span class="p">;</span>
<span class="n">pspectrum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">fs</span><span class="p">)</span><span class="w">  </span><span class="c">% Plotting Original Signal</span>
<span class="nb">legend</span><span class="p">(</span><span class="s">&#39;After IIR Bandpass&#39;</span><span class="p">,</span><span class="s">&#39;Orignial&#39;</span><span class="p">);</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;IIR BP Frequency response&#39;</span><span class="p">);</span>
</code></pre></div>
Based on the IIR codes above, I implemented the IIR difference equation with nested for-loop. To test the frequency response of the design, a random noise x with same sampling numbers (N = 262144) of the AM signal was generated as the input of IIR filter. The result is shown in Fig.4. </p>
<p><img alt="" src="../image/2023-12-09-23-36-30.png" />
<font size=2><center><em>Fig.4</em>. Testing Frequency Response of IIR BP Filter</center></font></p>
<p>In Fig.4, the IIR filter removes most of the out-of-band signal while keeps the signal between 16 kHz to 24 kHz. The testing frequency response is aligned with the designing expectation successfully.</p>
<p>Followed by the frequency response testing with random signal, I implemented the same IIR filter on the target AM signal, which is shown in Fig.5 below:</p>
<p><img alt="" src="../image/2023-12-10-00-08-00.png" />
<font size=2><center><em>Fig.5</em>. AM signal Frequency Response After IIR BP Filter</center></font></p>
<p>Fig.6 shown the comparison between original signal (after windowed) and BP filtered signal. The self-designed IIR BP significantly removed much of the noises in original signal.</p>
<p><img alt="" src="../image/2023-12-10-01-08-55.png" />
<font size=2><center><em>Fig.6</em>. AM signal After IIR BP Filter in Time Domain</center></font></p>
<p></font></p>
<h2 id="iv-task-3-siginal-mixing"><font size=5 face=Times New Roman>IV: Task-3: Siginal Mixing </font><a class="headerlink" href="#iv-task-3-siginal-mixing" title="Permanent link">&para;</a></h2>
<p><font size=3 face=Times New Roman></p>
<p>After the IIR band-pass filtering, the AM signal needs to be mixed with a local oscillator signal. As the Carrier Frequency is 20 kHz, the local oscillator frequency should be same. The mixing and plotting could be implemented with the codes below:</p>
<div class="highlight"><pre><span></span><code><span class="n">lo_frequency</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">20000</span><span class="p">;</span><span class="w">  </span><span class="c">% Local oscillitor Frequency (same as Carrier Frequency, 20 kHz from previous analysis)</span>
<span class="n">lo_signal1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">cos</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">pi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">lo_frequency</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t</span><span class="p">)</span><span class="o">&#39;</span><span class="p">;</span><span class="w"> </span><span class="c">% Real Part of the AM signal</span>
<span class="n">lo_signal2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">pi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">lo_frequency</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t</span><span class="p">)</span><span class="o">&#39;</span><span class="p">;</span><span class="w"> </span><span class="c">% Imaginary Part of the AM signal</span>
<span class="n">mixed_signal</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">BP_IIR</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="n">lo_signal1</span><span class="o">&#39;</span><span class="p">;</span><span class="w"> </span><span class="c">% Signal Mixing </span>
<span class="n">mixed_signal2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">BP_IIR</span><span class="o">.*</span><span class="w"> </span><span class="n">lo_signal2</span><span class="o">&#39;</span><span class="p">;</span>

<span class="nb">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">pspectrum</span><span class="p">(</span><span class="n">mixed_signal</span><span class="p">,</span><span class="n">fs</span><span class="p">);</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Real-Part After Mixing in Frequency Domain&#39;</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Time (s)&#39;</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Amplitude&#39;</span><span class="p">);</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">pspectrum</span><span class="p">(</span><span class="n">mixed_signal2</span><span class="p">,</span><span class="n">fs</span><span class="p">);</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Imaginary-Part After Mixing in Frequency Domain&#39;</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Time (s)&#39;</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Amplitude&#39;</span><span class="p">);</span>

<span class="nb">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">mixed_signal</span><span class="p">);</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Real-Part After Mixing in Time Domain&#39;</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Time (s)&#39;</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Amplitude&#39;</span><span class="p">);</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">mixed_signal2</span><span class="p">);</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Imaginary-Part After Mixing in Time Domain&#39;</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Time (s)&#39;</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Amplitude&#39;</span><span class="p">);</span>
</code></pre></div>
<p>Fig.7.1 and Fig.7.2 shown the result of mixed signals in time domain and frequency domain. In time domain, the features of both signal of Real Part and Imaginary Part are not obvious. In frequency domain, the original AM signals are separated into two significant frequency lobes: one higher lobe with the frequency of almost <span class="arithmatex">\(2f_c\)</span>, another lower lobe with the frequency less than 4 kHz. According to the principle of AM demodulation, the lower frequency lobe should be the target signal, which could be extracted with a Low-pass filter in next step.</p>
<p><img alt="" src="../image/2023-12-10-01-43-02.png" />
<font size=2><center><em>Fig.7.1</em>. Mixed Signal in Time Domain</center></font></p>
<p><img alt="" src="../image/2023-12-10-01-55-37.png" />
<font size=2><center><em>Fig.7.2</em>. Mixed Signal in Frequency Domain</center></font></p>
<p></font></p>
<h2 id="v-task-4-low-pass-fir-design"><font size=5 face=Times New Roman>V: Task-4: Low-pass FIR Design </font><a class="headerlink" href="#v-task-4-low-pass-fir-design" title="Permanent link">&para;</a></h2>
<p><font size=3 face=Times New Roman></p>
<p>According to the task requirements, a single stage FIR would be designed with the Pass-band Ripple less than 0.1 dB and Stop-band Attenuation larger than 60 dB. Following the Window Function Properties Table in Fig.8, only Blackman Function is appropriate to be applied in this design.</p>
<p><img alt="" src="../image/2023-12-10-09-38-05.png" />
<font size=2><center><em>Fig.8</em>. Window Function Properties Table</center></font></p>
<p>To design the single-stage FIR Low-pass filter, the FIR taps N should be defined at first. Applied with the requirements of 1 kHz transition width and Blackman Window, the normalized transition width and FIR taps could be calculate as:</p>
<div class="arithmatex">\[
\Delta F = \displaystyle\frac{1000}{96000} \approx 0.010417
\]</div>
<div class="arithmatex">\[
N_{Blackman}  = \displaystyle\frac{5.5}{\Delta F} = \frac{5.5}{0.010417} \approx 529
\]</div>
<p>With the FIR parameters above, the following codes could be implemented to testing the frequency response:</p>
<p><div class="highlight"><pre><span></span><code><span class="n">Fc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">4000</span><span class="o">/</span><span class="p">(</span><span class="n">Fs</span><span class="p">);</span><span class="w"> </span><span class="c">% Normalized cutting frequency </span>
<span class="n">m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">264</span><span class="p">;</span><span class="w"> </span><span class="c">% (N1-1)/2</span>
<span class="n">N1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c">% N1 = 5.5 / (1000/96000) = 528 (529)</span>

<span class="nb">tic</span><span class="p">;</span>
<span class="n">h_single_stage</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c">% Intialize the FIR array with zeros</span>
<span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">m</span>
<span class="w">    </span><span class="n">h_single_stage</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Fc</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">pi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Fc</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">pi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Fc</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="c">% Truncate the Low-pass Impluse Response Fucntion with m coefficients (first half of the FIR array)</span>
<span class="k">end</span>

<span class="n">h_single_stage</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="nb">fliplr</span><span class="p">(</span><span class="n">h_single_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">Fc</span><span class="w"> </span><span class="n">h_single_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)];</span>
<span class="c">% Construct the fliped another half, the 2Fc component in the middle and the original half of FIR Coefficients Array</span>
<span class="nb">toc</span><span class="p">;</span>

<span class="n">w</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">blackman</span><span class="p">(</span><span class="n">N1</span><span class="p">)</span><span class="o">&#39;</span><span class="p">;</span><span class="w"> </span><span class="c">% Applying the suitable window function </span>
<span class="n">h_single_stage</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">h_single_stage</span><span class="o">.*</span><span class="n">w</span><span class="p">;</span>

<span class="c">% Single stage convolution </span>
<span class="c">%x =mixed_signal;</span>
<span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">262144</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">512</span><span class="p">);</span><span class="w"> </span><span class="c">% Generate a Random Noises with same sampling points of AM signal (N = 262144)</span>

<span class="n">y_single_stage</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
<span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nb">j</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">h_single_stage</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="n">y_single_stage</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">y_single_stage</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="nb">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">h_single_stage</span><span class="p">(</span><span class="nb">j</span><span class="p">);</span><span class="w"> </span><span class="c">% Convolution of h_FIR() and x()</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">end</span>

<span class="nb">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span>
<span class="n">pspectrum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Fs</span><span class="p">);</span>
<span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
<span class="n">pspectrum</span><span class="p">(</span><span class="n">y_single_stage</span><span class="p">,</span><span class="n">Fs</span><span class="p">);</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Testing Frequency Response of FIR LP&#39;</span><span class="p">);</span>
<span class="nb">legend</span><span class="p">(</span><span class="s">&#39;Before Filtered&#39;</span><span class="p">,</span><span class="s">&#39;After Filtered&#39;</span><span class="p">);</span>
</code></pre></div>
The result of the single-stage FIR frequency response with a random noises shown in Fig.9. The FIR LP successfully removed most of the signal larger than 4 kHz.</p>
<p><img alt="" src="../image/2023-12-10-12-40-04.png" />
<font size=2><center><em>Fig.9</em>.Testing Frequency Response of Single stage FIR LP</center></font></p>
<p>After the testing in random noises, I applied the same FIR on the mixed signal from previous step. Fig.10 shown the filtered result of FIR LP in frequency domain. The FIR low-pass filter removed the signal larger than 4 kHz as we expected, which have a stop band at around 5 kHz.</p>
<p><img alt="" src="../image/2023-12-10-14-47-24.png" />
<font size=2><center><em>Fig.10</em>.Frequency Response of Single stage FIR LP applied on Mixed Signal</center></font></p>
<p>The time-domain analysis shown in Fig.11 also presents the obviously removing effect of the FIR Low-pass filter compared to the original mixed signals in both Real part and Imaginary part.</p>
<p><img alt="" src="../image/2023-12-10-14-57-05.png" />
<font size=2><center><em>Fig.11</em>.Time Domain of Single stage FIR LP applied on Mixed Signal</center></font></p>
<p>During the designing process of the single-stage FIR Low-pass filter, without any decimation of sampling frequency, the computational load could be calculated as:</p>
<div class="arithmatex">\[
Load = N\times F_s = 264 \times 96000 = 25.3 M\quad Mac/s
\]</div>
<p>Using the timing function, the total execution time of the FIR truncation Loop and FIR Convolution Loop is 0.839893 s. For the purpose of saving computational load and execution time, a multi-stage FIR low-pass filter would be designed with the decimation factors. In the following codes, it demonstrates a FIR filter with two stages. The first stage low-pass filter designed with <span class="arithmatex">\(f_c = 4\)</span> kHz and transition width <span class="arithmatex">\(w = 5\)</span> kHz. To reduce the computation load, a decimation factor of 2 is chosen, so that the sampling frequency of first stage FIR would be <span class="arithmatex">\(F_s/2 = 48\)</span> kHz. The FIR taps <span class="arithmatex">\(N_1\)</span> could be calculated as:</p>
<div class="arithmatex">\[
N_1 = \displaystyle\frac{5.5}{5/48} \approx 53
\]</div>
<p>In the second-stage FIR, the cutting frequency is same as the first stage (i.e.4 kHz), and the transition width <span class="arithmatex">\(w\)</span> is set to 1 kHz due to the task requirements. In this step, I applied the decimation factor 2 again at the result signal from the first-stage, so the total decimation factor would be 4. Thus the second-stage FIR sampling frequency would be <span class="arithmatex">\(F_s/4 = 24\)</span> kHz. With the calculation above, the FIR taps <span class="arithmatex">\(N_2\)</span> could be generated as:</p>
<div class="arithmatex">\[
N_2 = \displaystyle\frac{5.5}{1/24} \approx 133
\]</div>
<p>Applying the calculation results above, the codes of the two-stage IIR could be implemented as below:</p>
<p><div class="highlight"><pre><span></span><code><span class="c">% Single Stage FIR</span>
<span class="n">Fc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">4000</span><span class="o">/</span><span class="p">(</span><span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="c">% transition width = 4 to 9 (5kHz), decimation factor = 2</span>
<span class="n">m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">26</span><span class="p">;</span><span class="w"> </span>
<span class="n">N1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
<span class="nb">tic</span><span class="p">;</span><span class="w"> </span><span class="c">%Execution Timing Start</span>
<span class="n">h_single_stage</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">m</span>
<span class="w">    </span><span class="n">h_single_stage</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Fc</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">pi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Fc</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">pi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Fc</span><span class="p">);</span>
<span class="w">    </span><span class="c">% Impulse Response Function for LP Filter</span>
<span class="k">end</span>

<span class="n">h_single_stage</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="nb">fliplr</span><span class="p">(</span><span class="n">h_single_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Fc</span><span class="w"> </span><span class="n">h_single_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)];</span>
<span class="c">% Construct the fliped another half, the 2Fc component in the middle and the original half of FIR Coefficients Array</span>

<span class="n">w</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">blackman</span><span class="p">(</span><span class="n">N1</span><span class="p">)</span><span class="o">&#39;</span><span class="p">;</span><span class="c">% Applying the suitable window function </span>
<span class="n">h_single_stage</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">h_single_stage</span><span class="o">.*</span><span class="n">w</span><span class="p">;</span>

<span class="c">% Single stage convolution </span>
<span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="n">mixed_signal</span><span class="p">;</span>

<span class="n">y_single_stage</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
<span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nb">j</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">h_single_stage</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="n">y_single_stage</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">y_single_stage</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="nb">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">h_single_stage</span><span class="p">(</span><span class="nb">j</span><span class="p">);</span>
<span class="w">            </span><span class="c">% Convolution of h_FIR() and x()</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">end</span>

<span class="c">% Second Stage FIR</span>
<span class="n">m2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">66</span><span class="p">;</span><span class="w"> </span><span class="c">% transition width = 4 to 5 (1kHz), decimation factor = 4</span>
<span class="n">N2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">m2</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
<span class="n">Fc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">4000</span><span class="o">/</span><span class="p">(</span><span class="n">Fs</span><span class="o">/</span><span class="mi">4</span><span class="p">);</span>

<span class="n">h_two_stage</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">m2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">m2</span>
<span class="w">    </span><span class="n">h_two_stage</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Fc</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">pi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Fc</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">pi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Fc</span><span class="p">);</span>
<span class="k">end</span>

<span class="n">h_two_stage</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="nb">fliplr</span><span class="p">(</span><span class="n">h_two_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m2</span><span class="p">))</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Fc</span><span class="w"> </span><span class="n">h_two_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m2</span><span class="p">)];</span>

<span class="n">w</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">blackman</span><span class="p">(</span><span class="n">N2</span><span class="p">)</span><span class="o">&#39;</span><span class="p">;</span>
<span class="n">h_two_stage</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">h_two_stage</span><span class="o">.*</span><span class="n">w</span><span class="p">;</span>

<span class="c">% Second Stage Convolution </span>
<span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">y_single_stage</span><span class="p">;</span>
<span class="c">% Convolution of single_stage and second_stage</span>
<span class="n">y_two_stage</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
<span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nb">j</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">h_two_stage</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="n">y_two_stage</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">y_two_stage</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="nb">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">h_two_stage</span><span class="p">(</span><span class="nb">j</span><span class="p">);</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">end</span>
<span class="nb">toc</span><span class="p">;</span><span class="w"> </span><span class="c">%Execution Timing Ending</span>
</code></pre></div>
With the application of the two-stage FIR, the result of the processed mixed signals are plotted in Fig.12 and Fig.13. The noises signals out of 4 kHz are removed as expectations, which have the stop-band of  at 5 kHz approximately. </p>
<p><img alt="" src="../image/2023-12-10-18-09-11.png" />
<font size=2><center><em>Fig.12</em>.Frequency Domain of Two-stage FIR LP applied on Mixed Signal</center></font></p>
<p><img alt="" src="../image/2023-12-10-18-11-48.png" />
<font size=2><center><em>Fig.13</em>.Time Domain of Two-stage FIR LP applied on Mixed Signal</center></font></p>
<p>During the designing process of the Two-stage FIR Low-pass filter, considering the decimation during the sampling steps, the total computation load could be calculated as:</p>
<div class="arithmatex">\[
\begin{aligned}
   Load_2 &amp;= N_1\times F_{s1} +  N_2\times F_{s2} \\
   &amp;= 53 \times 48000 + 133 \times 24000 \\ 
   &amp;= 5.736M \quad Mac/s
\end{aligned}
\]</div>
<p>The measured execution time of FIR sampling and convolution for the Two-stage FIR is 0.274657s. Compared with the Single-stage FIR with 0.839893 s execution time and computation load of 25.3M Mac/s, the speed of the Two-stage IIR is almost 3 times faster. And the computation load would have 4 times saving. In conclusion, the two-stage IIR would have better efficiency and performance.</p>
<h2 id="vi-task-5-dc-removing"><font size=5 face=Times New Roman>VI: Task-5: DC Removing  </font><a class="headerlink" href="#vi-task-5-dc-removing" title="Permanent link">&para;</a></h2>
<p><font size=3 face=Times New Roman></p>
<p>After the low-pass filtering for the AM signals, a total magnitude of the AM signal should be calculated as a combination of Real Part and Imaginary Part:</p>
<div class="arithmatex">\[
Magnitude = \displaystyle\sqrt{Re^2 + Im^2}
\]</div>
<p>The calculation could be executed by the following codes:</p>
<div class="highlight"><pre><span></span><code><span class="n">magnitude_demodulated_signal</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="n">y_two_stage</span><span class="o">.^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_two_stage2</span><span class="o">.^</span><span class="mi">2</span><span class="p">);</span><span class="w"> </span>
<span class="c">%y_two_stage is the Re part signal while y_two_stage2 is the Im Part signal</span>
</code></pre></div>
<p>Due to the principle of AM modulation, the extra DC components should be filtered as the last step of demodulation. In this case, a IIR High-pass filter would be designed to remove the DC component. As the DC components would be close to y-axis in frequency domain, a small cutting frequency should be enough to remove most of the DC signal. In this IIR design, I choose <span class="arithmatex">\(f_c = 20\)</span> Hz. Applied with the same methods as the previous IIR band-pass filter, the high-pass IIR codes could be constructed as below:</p>
<div class="highlight"><pre><span></span><code><span class="n">fc1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>
<span class="p">[</span><span class="n">b1</span><span class="p">,</span><span class="n">a1</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">butter</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">fc</span><span class="o">/</span><span class="p">(</span><span class="n">fs</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="s">&#39;high&#39;</span><span class="p">);</span><span class="w">   </span><span class="c">% Butterworth IIR High-pass </span>

<span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">magnitude_demodulated_signal</span><span class="p">;</span><span class="w"> </span>

<span class="n">Order</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="n">delay_x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="n">Order</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="w">      </span><span class="c">% Create Delay Array for x and intialize with zeros (input)</span>
<span class="n">delay_y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="n">Order</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="w">        </span><span class="c">% Create Delay Array for x and intialize with zeros (output)</span>

<span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="p">=</span><span class="n">Order</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="w">          </span>
<span class="w">        </span><span class="n">delay_x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">delay_x</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span><span class="w">      </span><span class="c">% Right-shift the delay_x Array </span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">delay_x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="nb">i</span><span class="p">);</span><span class="w">              </span><span class="c">% Input each sample from signal x to the begining of delay_x</span>

<span class="w">    </span><span class="n">Accumulator</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">                    </span><span class="c">% Clear the Accumulator until the end of x-signal</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="n">Order</span><span class="o">+</span><span class="mi">1</span><span class="w">                     </span><span class="c">% Calculate the result from input x                     </span>
<span class="w">        </span><span class="n">Accumulator</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Accumulator</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">delay_x</span><span class="p">(</span><span class="n">n</span><span class="p">);</span><span class="w">    </span><span class="c">% + b(n)*x(i-n)</span>
<span class="w">    </span><span class="k">end</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="p">=</span><span class="mi">2</span><span class="p">:</span><span class="n">Order</span><span class="o">+</span><span class="mi">1</span><span class="w">                       </span><span class="c">% Calculate the result from output y                    </span>
<span class="w">        </span><span class="n">Accumulator</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Accumulator</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">delay_y</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span><span class="w">    </span><span class="c">% -a(n)*y(i-n-1)</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">HP_IIR</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Accumulator</span><span class="p">;</span><span class="w">        </span><span class="c">% Store the output data of this sample x(i)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="p">=</span><span class="n">Order</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="w">          </span>
<span class="w">        </span><span class="n">delay_y</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">delay_y</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span><span class="w">      </span><span class="c">% Right-shift the delay_y Array </span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">delay_y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Accumulator</span><span class="p">;</span>
<span class="k">end</span>
</code></pre></div>
<p>Applied with the IIR high-pass filter, the AM signal should be totally demodulated. Fig.14 shown the final demodulated signal in time and frequency domain. There is no DC component left at 0 Hz in the final result.</p>
<p><img alt="" src="../image/2023-12-10-22-03-09.png" />
<font size=2><center><em>Fig.14</em>.Final Demodulated Signal in Time and Frequency Domain</center></font></p>
<p>Using the sound() function, the three letter message could be demodulated as 'Y','J' and 'V'.</p>
<p></font></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 Ziyu Tian
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/Ziyu-Tian" target="_blank" rel="noopener" title="GitHub | Ziyu Tian" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.top", "navigation.indexes", "navigation.expand", "search.suggest", "search.highlight"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../../mkdocs/javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../../live2d-widget/autoload.js"></script>
      
    
  </body>
</html>